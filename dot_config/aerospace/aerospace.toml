# ~/.aerospace.toml

# Aerospace startup behavior
start-at-login = true
after-login-command = []

# Automatically move keymapp to focused workspace
exec-on-workspace-change = ['/Users/jkp/.config/aerospace/sticky-keymapp.sh']

after-startup-command = [
    'exec-and-forget /opt/homebrew/bin/borders active_color=0xff27AABB width=7 hidpi=on'
]

# Mouse focus behavior
on-focused-monitor-changed = ['move-mouse monitor-lazy-center']

# Misc UI tweaks
automatically-unhide-macos-hidden-apps = false

[key-mapping]
preset = 'qwerty'

[gaps]
inner.horizontal = 10
inner.vertical = 10
# Per-monitor left margin: 510px on external monitor for keymapp, 5px on laptop
outer.left = 5
outer.bottom = 5
outer.top = 5
outer.right = 5

# Primary bindings
[mode.main.binding]
   ctrl-alt-shift-r = 'reload-config'

   # --- Focus ---
   alt-ctrl-shift-m  = "focus --ignore-floating left"
   alt-ctrl-shift-n = "focus --ignore-floating down"
   alt-ctrl-shift-e  = "focus --ignore-floating up"
   alt-ctrl-shift-i  = "focus --ignore-floating right"

   alt-ctrl-shift-left  = "focus --ignore-floating left"
   alt-ctrl-shift-down = "focus --ignore-floating down"
   alt-ctrl-shift-up  = "focus --ignore-floating up"
   alt-ctrl-shift-right  = "focus --ignore-floating right"

   # Switch to floating-nav mode when you need to escape a floating window
   alt-ctrl-shift-f = "mode floating-nav"

   # --- Workspace navigation ---
   alt-ctrl-shift-comma     = "workspace --wrap-around prev"
   alt-ctrl-shift-period    = "workspace --wrap-around next"
   alt-ctrl-shift-backspace = "focus-back-and-forth"

   # --- Workspaces ---
   alt-ctrl-shift-1 = "workspace work-1"
   alt-ctrl-shift-2 = "workspace work-2"
   alt-ctrl-shift-3 = "workspace work-3"
   alt-ctrl-shift-4 = "workspace work-4"
   alt-ctrl-shift-5 = "workspace work-5"
   alt-ctrl-shift-6 = "workspace music"
   alt-ctrl-shift-7 = "workspace notes"
   alt-ctrl-shift-8 = "workspace comms"
   alt-ctrl-shift-9 = "workspace llm"
   alt-ctrl-shift-0 = "workspace browsing"

   # --- Move window to workspace ---
   alt-ctrl-shift-cmd-1 = ["move-node-to-workspace work-1", "workspace work-1"]
   alt-ctrl-shift-cmd-2 = ["move-node-to-workspace work-2", "workspace work-2"]
   alt-ctrl-shift-cmd-3 = ["move-node-to-workspace work-3", "workspace work-3"]
   alt-ctrl-shift-cmd-4 = ["move-node-to-workspace work-4", "workspace work-4"]
   alt-ctrl-shift-cmd-5 = ["move-node-to-workspace work-5", "workspace work-5"]
   alt-ctrl-shift-cmd-6 = ["move-node-to-workspace music", "workspace music"]
   alt-ctrl-shift-cmd-7 = ["move-node-to-workspace notes", "workspace notes"]
   alt-ctrl-shift-cmd-8 = ["move-node-to-workspace comms", "workspace comms"]
   alt-ctrl-shift-cmd-9 = ["move-node-to-workspace llm", "workspace llm"]
   alt-ctrl-shift-cmd-0 = ["move-node-to-workspace browsing", "workspace browsing"]

   # --- Move window on workspace ---
   alt-ctrl-shift-cmd-m = "move left"
   alt-ctrl-shift-cmd-n = "move down"
   alt-ctrl-shift-cmd-e = "move up"
   alt-ctrl-shift-cmd-i = "move right"

   alt-ctrl-shift-cmd-left = "move left"
   alt-ctrl-shift-cmd-down = "move down"
   alt-ctrl-shift-cmd-up = "move up"
   alt-ctrl-shift-cmd-right = "move right"

   # --- Resize (smart) ---
   alt-ctrl-shift-cmd-l = "resize smart -50"
   alt-ctrl-shift-cmd-u = "resize smart +50"

   # --- Layout toggles (Hyper) ---
   alt-ctrl-shift-cmd-f = "layout floating tiling"
   alt-ctrl-shift-cmd-enter = ['mode main','macos-native-fullscreen']
   alt-ctrl-shift-cmd-quote = "layout horizontal vertical"
   alt-ctrl-shift-cmd-tab = "layout accordion tiles"

   # --- Tidy ---
   alt-ctrl-shift-cmd-b = "balance-sizes"
   alt-ctrl-shift-cmd-semicolon  = "flatten-workspace-tree"

   # Launch and configure keymapp for external monitor
   alt-ctrl-shift-cmd-v = 'exec-and-forget ~/.config/aerospace/toggle-keymapp.sh'

# Floating navigation mode - can focus any window including tiled
[mode.floating-nav.binding]
   alt-ctrl-shift-h = ["focus left", "mode main"]
   alt-ctrl-shift-n = ["focus down", "mode main"]
   alt-ctrl-shift-e = ["focus up", "mode main"]
   alt-ctrl-shift-i = ["focus right", "mode main"]
   esc = "mode main"

# Auto-float keymapp window when detected
[[on-window-detected]]
   if.app-name-regex-substring = 'Keymapp'
   run = ['layout floating']

[[on-window-detected]]
   if.app-name-regex-substring = 'Spotify'
   run = ['move-node-to-workspace music']

[[on-window-detected]]
   if.app-name-regex-substring = 'Claude'
   run = ['move-node-to-workspace llm']

[[on-window-detected]]
   if.app-name-regex-substring = 'ChatGPT'
   run = ['move-node-to-workspace llm']
